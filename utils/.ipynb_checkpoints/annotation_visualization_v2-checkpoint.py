import numpy as np
import cv2, h5py
from PIL import Image

test_size       = 5050
h               = h5py.File('/home/anil/Desktop/FuseNet/Server_Files/NYU/Predictions/nyu_prediction_77500.h5')
predictions     = np.uint8(h['predicted_images'])
#h               = h5py.File('/home/anil/Desktop/FuseNet/NYU_v2_dataset/nyu_labels.h5')
#predictions     = np.uint8(h['label_test'])

palette         = [0, 0, 0, 
0.501960784313726, 0, 0, 
0, 0.501960784313726, 0, 
0.501960784313726, 0.501960784313726, 0, 
0, 0, 0.501960784313726,
0.501960784313726, 0, 0.501960784313726,
0, 0.501960784313726, 0.501960784313726,
0.501960784313726, 0.501960784313726, 0.501960784313726,
0.250980392156863, 0, 0,
0.752941176470588, 0, 0,
0.250980392156863, 0.501960784313726, 0,
0.752941176470588, 0.501960784313726, 0,
0.250980392156863, 0, 0.501960784313726,
0.752941176470588, 0, 0.501960784313726,
0.250980392156863, 0.501960784313726, 0.501960784313726,
0.752941176470588, 0.501960784313726, 0.501960784313726,
0, 0.250980392156863, 0,
0.501960784313726, 0.250980392156863, 0,
0, 0.752941176470588, 0,
0.501960784313726, 0.752941176470588, 0,
0, 0.250980392156863, 0.501960784313726,
0.501960784313726, 0.250980392156863, 0.501960784313726,
0, 0.752941176470588, 0.501960784313726,
0.501960784313726, 0.752941176470588, 0.501960784313726,
0.250980392156863, 0.250980392156863, 0,
0.752941176470588, 0.250980392156863, 0,
0.250980392156863, 0.752941176470588, 0,
0.752941176470588, 0.752941176470588, 0,
0.250980392156863, 0.250980392156863, 0.501960784313726,
0.752941176470588, 0.250980392156863, 0.501960784313726,
0.250980392156863, 0.752941176470588, 0.501960784313726,
0.752941176470588, 0.752941176470588, 0.501960784313726,
0, 0, 0.250980392156863,
0.501960784313726, 0, 0.250980392156863,
0, 0.501960784313726, 0.250980392156863,
0.501960784313726, 0.501960784313726, 0.250980392156863,
0, 0, 0.752941176470588,
0.501960784313726, 0, 0.752941176470588]

palette         = np.uint8(np.multiply(255, palette))
#predictions     = np.uint8(predictions)

for i in range(0,test_size):
        j       = i +1
        img     = Image.fromarray(predictions[i,:,:], mode="P")
        img.convert("P")        
        img.putpalette(palette)
        #img.save('/home/anil/Desktop/FuseNet/Server_Files/NYU/Predictions_colored/Pred/prediction' + str(j) + '.png')
        img.save('/home/anil/Desktop/FuseNet/Server_Files/SUN/Predictions_colored/Pred/prediction' + str(j) + '.png')
        print('[PROGRESS] %i of %i' %(j,test_size))

print('[COMPLETED] Boring prediction images are now nice and colorful!')
h.close()

